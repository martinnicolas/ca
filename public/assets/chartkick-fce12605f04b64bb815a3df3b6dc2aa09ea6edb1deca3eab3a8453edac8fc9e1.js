!function(t){"use strict";function e(t){return"[object Array]"===Object.prototype.toString.call(t)}function i(t){return t instanceof Function}function n(t){return!i(t)&&t instanceof Object}function a(t,i){var o;for(o in i)n(i[o])||e(i[o])?(n(i[o])&&!n(t[o])&&(t[o]={}),e(i[o])&&!e(t[o])&&(t[o]=[]),a(t[o],i[o])):void 0!==i[o]&&(t[o]=i[o])}function o(t,e){var i={};return a(i,t),a(i,e),i}function r(t){var e,i,n,a,o,r,s,l,u,c,h;return c=Object.prototype.toString.call(t),"[object Date]"===c?t:"[object String]"===c?(n=t.match(q),n?(h=parseInt(n[1],10),r=parseInt(n[3],10)-1,e=parseInt(n[5],10),i=parseInt(n[7],10),o=n[9]?parseInt(n[9],10):0,u=n[11]?parseInt(n[11],10):0,a=n[12]?1e3*parseFloat(U+n[12].slice(1)):0,l=Date.UTC(h,r,e,i,o,u,a),n[13]&&n[14]&&(s=60*n[15],n[17]&&(s+=parseInt(n[17],10)),s*="-"===n[14]?-1:1,l-=60*s*1e3),new Date(l)):void 0):void 0}function s(t){var e,i,n;for(e=0;e<t.length;e++)for(n=t[e].data,i=0;i<n.length;i++)if(n[i][1]<0)return!0;return!1}function l(t,e,i,n,a,r,l){return function(u,c,h){var d=o({},t);return d=o(d,h||{}),c.hideLegend&&e(d),"min"in c?i(d,c.min):s(u)||i(d,0),c.max&&n(d,c.max),"stacked"in c&&a(d,c.stacked),c.colors&&(d.colors=c.colors),c.xtitle&&r(d,c.xtitle),c.ytitle&&l(d,c.ytitle),d=o(d,c.library||{})}}function u(t,e){document.body.innerText?t.innerText=e:t.textContent=e}function c(t,e){u(t,"Error Loading Chart: "+e),t.style.color="#ff0000"}function h(t,e,i){d(e,i,function(e,i,n){var a="string"==typeof n?n:n.message;c(t,a)})}function d(e,i,n){var a=t.jQuery||t.Zepto||t.$;if(a)a.ajax({dataType:"json",url:e,success:i,error:n});else{var o=new XMLHttpRequest;o.open("GET",e,!0),o.setRequestHeader("Content-Type","application/json"),o.onload=function(){200===o.status?i(JSON.parse(o.responseText),o.statusText,o):n(o,"error",o.statusText)},o.send()}}function f(t,e){try{e(t)}catch(i){throw c(t.element,i.message),i}}function p(t,e){"string"==typeof t.dataSource?h(t.element,t.dataSource,function(i){t.data=i,f(t,e)}):(t.data=t.dataSource,f(t,e))}function g(t){return""+t}function m(t){return parseFloat(t)}function v(t){var e,i,n,a;if("object"!=typeof t)if("number"==typeof t)t=new Date(1e3*t);else{if(e=t.match(Q))return i=parseInt(e[1],10),n=parseInt(e[3],10)-1,a=parseInt(e[5],10),new Date(i,n,a);var o=t.replace(/ /,"T").replace(" ","").replace("UTC","Z");t=r(o)||new Date(t)}return t}function b(t){if(!e(t)){var i,n=[];for(i in t)t.hasOwnProperty(i)&&n.push([i,t[i]]);t=n}return t}function y(t,e){return t[0].getTime()-e[0].getTime()}function _(t,e){return t-e}function x(){!G&&"Highcharts"in t&&(G=new function(){var e=t.Highcharts;this.name="highcharts";var i={chart:{},xAxis:{title:{text:null},labels:{style:{fontSize:"12px"}}},yAxis:{title:{text:null},labels:{style:{fontSize:"12px"}}},title:{text:null},credits:{enabled:!1},legend:{borderWidth:0},tooltip:{style:{fontSize:"12px"}},plotOptions:{areaspline:{},series:{marker:{}}}},n=function(t){t.legend.enabled=!1},a=function(t,e){t.yAxis.min=e},r=function(t,e){t.yAxis.max=e},s=function(t,e){t.plotOptions.series.stacking=e?"normal":null},u=function(t,e){t.xAxis.title.text=e},c=function(t,e){t.yAxis.title.text=e},h=l(i,n,a,r,s,u,c);this.renderLineChart=function(t,i){i=i||"spline";var n={};"areaspline"===i&&(n={plotOptions:{areaspline:{stacking:"normal"},series:{marker:{enabled:!1}}}});var a,o,r,s=h(t.data,t.options,n);s.xAxis.type=t.options.discrete?"category":"datetime",s.chart.type||(s.chart.type=i),s.chart.renderTo=t.element.id;var l=t.data;for(o=0;o<l.length;o++){if(a=l[o].data,!t.options.discrete)for(r=0;r<a.length;r++)a[r][0]=a[r][0].getTime();l[o].marker={symbol:"circle"}}s.series=l,new e.Chart(s)},this.renderScatterChart=function(t){var i={},n=h(t.data,t.options,i);n.chart.type="scatter",n.chart.renderTo=t.element.id,n.series=t.data,new e.Chart(n)},this.renderPieChart=function(t){var n={};t.options.colors&&(n.colors=t.options.colors);var a=o(o(i,n),t.options.library||{});a.chart.renderTo=t.element.id,a.series=[{type:"pie",name:t.options.label||"Value",data:t.data}],new e.Chart(a)},this.renderColumnChart=function(t,i){i=i||"column";var n,a,o,r,s=t.data,l=h(s,t.options),u=[];for(l.chart.type=i,l.chart.renderTo=t.element.id,n=0;n<s.length;n++)for(o=s[n],a=0;a<o.data.length;a++)r=o.data[a],u[r[0]]||(u[r[0]]=new Array(s.length)),u[r[0]][n]=r[1];var c=[];for(n in u)u.hasOwnProperty(n)&&c.push(n);l.xAxis.categories=c;var d=[];for(n=0;n<s.length;n++){for(r=[],a=0;a<c.length;a++)r.push(u[c[a]][n]||0);d.push({name:s[n].name,data:r})}l.series=d,new e.Chart(l)};var d=this;this.renderBarChart=function(t){d.renderColumnChart(t,"bar")},this.renderAreaChart=function(t){d.renderLineChart(t,"areaspline")}},J.push(G)),!$&&t.google&&(t.google.setOnLoadCallback||t.google.charts)&&($=new function(){var e=t.google;this.name="google";var i={},n=[],a=function(){for(var t,i,a=0;a<n.length;a++)t=n[a],i=e.visualization&&("corechart"===t.pack&&e.visualization.LineChart||"timeline"===t.pack&&e.visualization.Timeline),i&&(t.callback(),n.splice(a,1),a--)},r=function(o,r){if(r||(r=o,o="corechart"),n.push({pack:o,callback:r}),i[o])a();else{i[o]=!0;var s={packages:[o],callback:a};K.language&&(s.language=K.language),t.google.setOnLoadCallback?e.load("visualization","1",s):e.charts.load("current",s)}},s={chartArea:{},fontName:"'Lucida Grande', 'Lucida Sans Unicode', Verdana, Arial, Helvetica, sans-serif",pointSize:6,legend:{textStyle:{fontSize:12,color:"#444"},alignment:"center",position:"right"},curveType:"function",hAxis:{textStyle:{color:"#666",fontSize:12},titleTextStyle:{},gridlines:{color:"transparent"},baselineColor:"#ccc",viewWindow:{}},vAxis:{textStyle:{color:"#666",fontSize:12},titleTextStyle:{},baselineColor:"#ccc",viewWindow:{}},tooltip:{textStyle:{color:"#666",fontSize:12}}},u=function(t){t.legend.position="none"},c=function(t,e){t.vAxis.viewWindow.min=e},h=function(t,e){t.vAxis.viewWindow.max=e},d=function(t,e){t.hAxis.viewWindow.min=e},f=function(t,e){t.hAxis.viewWindow.max=e},p=function(t,e){t.isStacked=!!e},g=function(t,e){t.hAxis.title=e,t.hAxis.titleTextStyle.italic=!1},v=function(t,e){t.vAxis.title=e,t.vAxis.titleTextStyle.italic=!1},b=l(s,u,c,h,p,g,v),_=function(t,i){var n,a,o,r,s,l=[];for(n=0;n<t.length;n++)for(o=t[n],a=0;a<o.data.length;a++)r=o.data[a],s="datetime"===i?r[0].getTime():r[0],l[s]||(l[s]=new Array(t.length)),l[s][n]=m(r[1]);var u,c=[],h=!0;for(n in l)l.hasOwnProperty(n)&&("datetime"===i?(u=new Date(m(n)),h=h&&S(u)):u="number"===i?m(n):n,c.push([u].concat(l[n])));"datetime"===i&&c.sort(y);var d=new e.visualization.DataTable;for(i="datetime"===i&&h?"date":i,d.addColumn(i,""),n=0;n<t.length;n++)d.addColumn("number",t[n].name);return d.addRows(c),d},x=function(e){t.attachEvent?t.attachEvent("onresize",e):t.addEventListener&&t.addEventListener("resize",e,!0),e()};this.renderLineChart=function(t){r(function(){var i=b(t.data,t.options),n=_(t.data,t.options.discrete?"string":"datetime");t.chart=new e.visualization.LineChart(t.element),x(function(){t.chart.draw(n,i)})})},this.renderPieChart=function(t){r(function(){var i={chartArea:{top:"10%",height:"80%"}};t.options.colors&&(i.colors=t.options.colors);var n=o(o(s,i),t.options.library||{}),a=new e.visualization.DataTable;a.addColumn("string",""),a.addColumn("number","Value"),a.addRows(t.data),t.chart=new e.visualization.PieChart(t.element),x(function(){t.chart.draw(a,n)})})},this.renderColumnChart=function(t){r(function(){var i=b(t.data,t.options),n=_(t.data,"string");t.chart=new e.visualization.ColumnChart(t.element),x(function(){t.chart.draw(n,i)})})},this.renderBarChart=function(t){r(function(){var i={hAxis:{gridlines:{color:"#ccc"}}},n=l(s,u,d,f,p,g,v)(t.data,t.options,i),a=_(t.data,"string");t.chart=new e.visualization.BarChart(t.element),x(function(){t.chart.draw(a,n)})})},this.renderAreaChart=function(t){r(function(){var i={isStacked:!0,pointSize:0,areaOpacity:.5},n=b(t.data,t.options,i),a=_(t.data,t.options.discrete?"string":"datetime");t.chart=new e.visualization.AreaChart(t.element),x(function(){t.chart.draw(a,n)})})},this.renderGeoChart=function(t){r(function(){var i={legend:"none",colorAxis:{colors:t.options.colors||["#f6c7b6","#ce502d"]}},n=o(o(s,i),t.options.library||{}),a=new e.visualization.DataTable;a.addColumn("string",""),a.addColumn("number",t.options.label||"Value"),a.addRows(t.data),t.chart=new e.visualization.GeoChart(t.element),x(function(){t.chart.draw(a,n)})})},this.renderScatterChart=function(t){r(function(){var i={},n=b(t.data,t.options,i),a=_(t.data,"number");t.chart=new e.visualization.ScatterChart(t.element),x(function(){t.chart.draw(a,n)})})},this.renderTimeline=function(t){r("timeline",function(){var i={legend:"none"};t.options.colors&&(i.colors=t.options.colors);var n=o(o(s,i),t.options.library||{}),a=new e.visualization.DataTable;a.addColumn({type:"string",id:"Name"}),a.addColumn({type:"date",id:"Start"}),a.addColumn({type:"date",id:"End"}),a.addRows(t.data),t.element.style.lineHeight="normal",t.chart=new e.visualization.Timeline(t.element),x(function(){t.chart.draw(a,n)})})}},J.push($)),!X&&"Chart"in t&&(X=new function(){var e=t.Chart;this.name="chartjs";var i={maintainAspectRatio:!1,animation:!1},n={scales:{yAxes:[{ticks:{maxTicksLimit:4},scaleLabel:{fontSize:16,fontColor:"#333"}}],xAxes:[{gridLines:{drawOnChartArea:!1},scaleLabel:{fontSize:16,fontColor:"#333"},time:{},ticks:{}}]},legend:{}},a=["#3366CC","#DC3912","#FF9900","#109618","#990099","#3B3EAC","#0099C6","#DD4477","#66AA00","#B82E2E","#316395","#994499","#22AA99","#AAAA11","#6633CC","#E67300","#8B0707","#329262","#5574A6","#3B3EAC"],r=function(t){t.legend.display=!1},s=function(t,e){null!==e&&(t.scales.yAxes[0].ticks.min=e)},u=function(t,e){t.scales.yAxes[0].ticks.max=e},c=function(t,e){null!==e&&(t.scales.xAxes[0].ticks.min=e)},h=function(t,e){t.scales.xAxes[0].ticks.max=e},d=function(t,e){t.scales.xAxes[0].stacked=!!e,t.scales.yAxes[0].stacked=!!e},f=function(t,e){t.scales.xAxes[0].scaleLabel.display=!0,t.scales.xAxes[0].scaleLabel.labelString=e},p=function(t,e){t.scales.yAxes[0].scaleLabel.display=!0,t.scales.yAxes[0].scaleLabel.labelString=e},v=function(t,i,n,a){t.element.innerHTML="<canvas></canvas>";var o=t.element.getElementsByTagName("CANVAS")[0];t.chart=new e(o,{type:i,data:n,options:a})},b=function(t,e){var i=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(t);return i?"rgba("+parseInt(i[1],16)+", "+parseInt(i[2],16)+", "+parseInt(i[3],16)+", "+e+")":t},y=function(t,e,i){var n=Math.ceil(t.element.offsetWidth/4/e.labels.length);n>25&&(n=25),i.scales.xAxes[0].ticks.callback=function(t){return t=g(t),t.length>n?t.substring(0,n-2)+"...":t}},x=l(o(i,n),r,s,u,d,f,p),w=function(t,e,i){var n,r,s,l,u,c,h=[],d=[],f=t.options.colors||a,p=!0,g=!0,v=!0,y=!0,x=!0,w=!0,I=("line"===i||"area"===i)&&!t.options.discrete,A=t.data,P=[],E=[];for(r=0;r<A.length;r++)for(l=A[r],s=0;s<l.data.length;s++)u=l.data[s],c=I?u[0].getTime():u[0],E[c]||(E[c]=new Array(A.length)),E[c][r]=m(u[1]),-1===P.indexOf(c)&&P.push(c);I&&P.sort(_);var F=[];for(s=0;s<A.length;s++)F.push([]);var O,N;for(N=0;N<P.length;N++)for(r=P[N],I?(O=new Date(m(r)),p=p&&S(O),n||(n=O.getDay()),g=g&&D(O,n),v=v&&T(O),y=y&&M(O),x=x&&k(O),w=w&&C(O)):O=r,d.push(O),s=0;s<A.length;s++)F[s].push(E[r][s]);for(r=0;r<A.length;r++){l=A[r];var L="line"!==i?b(f[r],.5):f[r],R={label:l.name,data:F[r],fill:"area"===i,borderColor:f[r],backgroundColor:L,pointBackgroundColor:f[r],borderWidth:2};h.push(o(R,l.library||{}))}if(I&&d.length>0){var H=d[0].getTime(),W=d[0].getTime();for(r=1;r<d.length;r++)O=d[r].getTime(),H>O&&(H=O),O>W&&(W=O);var z=(W-H)/864e5;if(!e.scales.xAxes[0].time.unit){var j;if(y||z>3650?(e.scales.xAxes[0].time.unit="year",j=365):v||z>300?(e.scales.xAxes[0].time.unit="month",j=30):p||z>10?(e.scales.xAxes[0].time.unit="day",j=1):x?(e.scales.xAxes[0].time.unit="hour",j=1/24):w&&(e.scales.xAxes[0].time.displayFormats={minute:"h:mm a"},e.scales.xAxes[0].time.unit="minute",j=1/24/60),j&&z>0){var B=Math.ceil(z/j/(t.element.offsetWidth/100));g&&1===j&&(B=7*Math.ceil(B/7)),e.scales.xAxes[0].time.unitStepSize=B}}e.scales.xAxes[0].time.tooltipFormat||(p?e.scales.xAxes[0].time.tooltipFormat="ll":x?e.scales.xAxes[0].time.tooltipFormat="MMM D, h a":w&&(e.scales.xAxes[0].time.tooltipFormat="h:mm a"))}var V={labels:d,datasets:h};return V};this.renderLineChart=function(t,e){var i={};!t.options.max&&A(t.data)&&(t.options.max=1);var n=x(t.data,o(i,t.options)),a=w(t,n,e||"line");n.scales.xAxes[0].type=t.options.discrete?"category":"time",v(t,"line",a,n)},this.renderPieChart=function(t){for(var e=o(i,t.options.library||{}),n=[],r=[],s=0;s<t.data.length;s++){var l=t.data[s];n.push(l[0]),r.push(l[1])}var u={labels:n,datasets:[{data:r,backgroundColor:t.options.colors||a}]};v(t,"pie",u,e)},this.renderColumnChart=function(t,e){var a;a="bar"===e?l(o(i,n),r,c,h,d,f,p)(t.data,t.options):x(t.data,t.options);var s=w(t,a,"column");y(t,s,a),v(t,"bar"===e?"horizontalBar":"bar",s,a)};var I=this;this.renderAreaChart=function(t){I.renderLineChart(t,"area")},this.renderBarChart=function(t){I.renderColumnChart(t,"bar")},this.renderScatterChart=function(t){for(var e=x(t.data,t.options),i=t.options.colors||a,n=[],o=t.data,r=0;r<o.length;r++){for(var s=o[r],l=[],u=0;u<s.data.length;u++)l.push({x:m(s.data[u][0]),y:m(s.data[u][1])});n.push({label:s.name,showLine:!1,data:l,borderColor:i[r],backgroundColor:i[r],pointBackgroundColor:i[r]})}var c={datasets:n};e.scales.xAxes[0].type="linear",e.scales.xAxes[0].position="bottom",v(t,"line",c,e)}},J.unshift(X))}function w(t,e){var n,a,o,r;for(o="render"+t,r=e.options.adapter,x(),n=0;n<J.length;n++)if(a=J[n],(!r||r===a.name)&&i(a[o]))return a[o](e);throw new Error("No adapter found")}function C(t){return 0===t.getMilliseconds()&&0===t.getSeconds()}function k(t){return C(t)&&0===t.getMinutes()}function S(t){return k(t)&&0===t.getHours()}function D(t,e){return S(t)&&t.getDay()===e}function T(t){return S(t)&&1===t.getDate()}function M(t){return T(t)&&0===t.getMonth()}function I(t){return!isNaN(v(t))&&g(t).length>=6}function A(t){var e,i,n;for(e=0;e<t.length;e++)for(n=t[e].data,i=0;i<n.length;i++)if(0!=n[i][1])return!1;return!0}function P(t){var e,i,n;for(e=0;e<t.length;e++)for(n=b(t[e].data),i=0;i<n.length;i++)if(!I(n[i][0]))return!0;return!1}function E(t,i,n){var a;for(!e(t)||"object"!=typeof t[0]||e(t[0])?(t=[{name:i.label||"Value",data:t}],i.hideLegend=!0):i.hideLegend=!1,null!==i.discrete&&void 0!==i.discrete||(i.discrete=P(t)),i.discrete&&(n="string"),a=0;a<t.length;a++)t[a].data=tt(b(t[a].data),n);return t}function F(t){var e,i=b(t);for(e=0;e<i.length;e++)i[e]=[g(i[e][0]),m(i[e][1])];return i}function O(t){var e;for(e=0;e<t.length;e++)t[e][1]=v(t[e][1]),t[e][2]=v(t[e][2]);return t}function N(t){t.data=E(t.data,t.options,"datetime"),w("LineChart",t)}function L(t){t.data=E(t.data,t.options,"string"),w("ColumnChart",t)}function R(t){t.data=F(t.data),w("PieChart",t)}function H(t){t.data=E(t.data,t.options,"string"),w("BarChart",t)}function W(t){t.data=E(t.data,t.options,"datetime"),w("AreaChart",t)}function z(t){t.data=F(t.data),w("GeoChart",t)}function j(t){t.data=E(t.data,t.options,"number"),w("ScatterChart",t)}function B(t){t.data=O(t.data),w("Timeline",t)}function V(t,e,i,n,a){var o;if("string"==typeof e&&(o=e,e=document.getElementById(e),!e))throw new Error("No element with id "+o);t.element=e,t.options=n||{},t.dataSource=i,t.getElement=function(){return e},t.getData=function(){return t.data},t.getOptions=function(){return n||{}},t.getChartObject=function(){return t.chart},Y.charts[e.id]=t,p(t,a)}var Y,q,U,$,G,X,K=t.Chartkick||{},J=[],Q=/^(\d\d\d\d)(\-)?(\d\d)(\-)?(\d\d)$/i;q=/(\d\d\d\d)(\-)?(\d\d)(\-)?(\d\d)(T)?(\d\d)(:)?(\d\d)?(:)?(\d\d)?([\.,]\d+)?($|Z|([\+\-])(\d\d)(:)?(\d\d)?)/i,U=String(1.5).charAt(1);var Z=function(t,e){return t="number"===e?m(t):"datetime"===e?v(t):g(t)},tt=function(t,e){var i,n,a=[];for(n=0;n<t.length;n++)i=Z(t[n][0],e),a.push([i,m(t[n][1])]);return"datetime"===e&&a.sort(y),a};Y={LineChart:function(t,e,i){V(this,t,e,i,N)},PieChart:function(t,e,i){V(this,t,e,i,R)},ColumnChart:function(t,e,i){V(this,t,e,i,L)},BarChart:function(t,e,i){V(this,t,e,i,H)},AreaChart:function(t,e,i){V(this,t,e,i,W)},GeoChart:function(t,e,i){V(this,t,e,i,z)},ScatterChart:function(t,e,i){V(this,t,e,i,j)},Timeline:function(t,e,i){V(this,t,e,i,B)},charts:{},configure:function(t){for(var e in t)t.hasOwnProperty(e)&&(K[e]=t[e])}},"object"==typeof module&&"object"==typeof module.exports?module.exports=Y:t.Chartkick=Y}(window);